'''
Value at Risk (VaR) — це міра фінансового ризику,
яка показує найбільшу можливу втрату за певний період часу з заданим рівнем довіри.
VaR використовується для оцінки ризику інвестиційного портфеля або окремих активів і вказує,
яку максимальну втрату можна очікувати в найгіршому випадку при нормальних ринкових умовах.
 VaR зазвичай розраховується з певним рівнем довіри, наприклад, 95% або 99%.
  Якщо ми використовуємо 95% рівень довіри, це означає, що в 95% випадків втрати
 не перевищать розраховану величину, але є 5% ймовірність, що втрати будуть більшими.
Щоб розрахувати Value at Risk (VaR) на 2025, 2026 і 2027 роки за допомогою історичного методу,
 ми виконуємо такі кроки:

Обчислення історичних доходностей (returns): Ми беремо фактичні дані з 2019 по 2024 рік
 і обчислюємо зміни у відсотках між роками, щоб отримати річну доходність.

Розрахунок VaR за допомогою історичного методу: Для цього методу ми беремо до уваги 95% довірчий рівень,
 що означає, що ми розраховуємо найбільшу можливу втрату у 5% випадків на основі історичних даних.

Прогнозування VaR на 2025, 2026 і 2027 роки: На основі фактичної вартості за 2024 рік та використовуючи
обчислену доходність, ми прогнозуємо потенційні втрати для кожного наступного року.
'''



import pandas as pd
import numpy as np

# Завантаження Excel-файлу
file_path = 'C:\\Users\\0487\\Desktop\\22.xlsx'
data = pd.read_excel(file_path, None)

# Витяг даних із листа
df = data['Sheet1']

# Присвоєння назв колонкам для зручності
df.columns = ['fact_2019', 'fact_2020', 'fact_2021', 'fact_2022', 'fact_2023', 'fact_2024']

# Обчислення відсоткових змін між роками (доходностей)
returns = df.pct_change(axis=1).iloc[0, 1:]  # Пропускаємо перший стовпець як базовий рік

# Визначення перцентиля для 95% рівня довіри
confidence_level = 0.95
VaR_percentile = np.percentile(returns, (1 - confidence_level) * 100)

# Фактичні дані за 2024 рік
fact_2024 = df['fact_2024'][0]

# Прогнозування VaR для 2025, 2026 і 2027 років
VaR_2025 = fact_2024 * (1 + VaR_percentile)
VaR_2026 = VaR_2025 * (1 + VaR_percentile)
VaR_2027 = VaR_2026 * (1 + VaR_percentile)

# Виведення результатів
print(f"VaR для 2025 року: {VaR_2025:.2f}")
print(f"VaR для 2026 року: {VaR_2026:.2f}")
print(f"VaR для 2027 року: {VaR_2027:.2f}")

'''VaR для 2020 року: 7938150.00
VaR для 2021 року: 7356636.00
VaR для 2022 року: 3925547.00
VaR для 2023 року: 4343122.00
VaR для 2024 року: 5032953.00
VaR для 2025 року: 3081344.36
VaR для 2026 року: 1886503.43
VaR для 2027 року: 1154981.32
'''